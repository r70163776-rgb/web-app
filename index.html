<!DOCTYPE html>
<html lang="en">
<head><script src='//libtl.com/sdk.js' data-zone='10139509' data-sdk='show_10139509'></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniPlay — High CPM</title>
    <style>
        :root {
            --primary: #06b6d4;
            --primary-dark: #0891b2;
            --background: #071026;
            --card-bg: #0f172a;
            --text: #e2e8f0;
            --text-muted: #94a3b8;
            --border: #1e293b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        body {
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 16px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            flex: 1;
        }
        
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
        
        .header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }
        
        .header p {
            color: var(--text-muted);
            font-size: 15px;
        }
        
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border: 1px solid var(--border);
        }
        
        .play-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 320px;
            text-align: center;
        }
        
        .score {
            font-size: 72px;
            font-weight: 800;
            margin-bottom: 16px;
            background: linear-gradient(90deg, var(--primary), #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .instructions {
            color: var(--text-muted);
            margin-bottom: 24px;
            font-size: 16px;
            max-width: 300px;
        }
        
        .instructions strong {
            color: var(--primary);
        }
        
        .actions {
            display: flex;
            gap: 12px;
        }
        
        button {
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 15px;
        }
        
        button.primary {
            background: linear-gradient(90deg, var(--primary), #7c3aed);
            color: white;
        }
        
        button.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
        }
        
        button.secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-muted);
        }
        
        button.secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .sidebar h2 {
            font-size: 18px;
            margin-bottom: 16px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .sidebar h2::before {
            content: "";
            display: block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--primary);
        }
        
        .session-info {
            margin-bottom: 24px;
        }
        
        .session-time {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 8px;
        }
        
        .ad-status {
            margin-bottom: 24px;
        }
        
        .status-indicator {
            display: inline-block;
            padding: 6px 12px;
            background: rgba(6, 182, 212, 0.1);
            border-radius: 20px;
            font-size: 14px;
            color: var(--primary);
            border: 1px solid rgba(6, 182, 212, 0.3);
        }
        
        .manual-triggers {
            margin-bottom: 24px;
        }
        
        .trigger-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .trigger-buttons button {
            width: 100%;
            justify-content: center;
        }
        
        .footer {
            text-align: center;
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 14px;
        }
        
        .ad-preview {
            margin-top: 20px;
            padding: 16px;
            background: rgba(6, 182, 212, 0.05);
            border-radius: 8px;
            border: 1px dashed var(--primary);
        }
        
        .ad-preview h3 {
            font-size: 16px;
            margin-bottom: 12px;
            color: var(--primary);
        }
        
        .ad-types {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .ad-type {
            padding: 8px 12px;
            background: rgba(6, 182, 212, 0.1);
            border-radius: 6px;
            font-size: 13px;
            color: var(--primary);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>MiniPlay — High CPM</h1>
        <p>Popunder + Interstitial + In-Page Push — Target: USA + Global</p>
    </div>
    
    <div class="container">
        <main>
            <div class="card">
                <div class="play-area">
                    <div class="score" id="score">0</div>
                    <div class="instructions">
                        Tap <strong>PLAY</strong> to start — first gesture will unlock ad triggers
                    </div>
                    <div class="actions">
                        <button class="primary" id="playBtn">PLAY</button>
                        <button class="secondary" id="claimBtn">CLAIM</button>
                    </div>
                </div>
            </div>
            
            <div class="ad-preview">
                <h3>Ad Formats Preview</h3>
                <div class="ad-types">
                    <div class="ad-type">Popunder</div>
                    <div class="ad-type">Interstitial</div>
                    <div class="ad-type">In-Page Push</div>
                </div>
            </div>
        </main>
        
        <aside>
            <div class="card">
                <div class="sidebar">
                    <div class="session-info">
                        <h2>Session</h2>
                        <div class="session-time" id="sessionTime">0s</div>
                    </div>
                    
                    <div class="ad-status">
                        <h2>Ad Status</h2>
                        <div class="status-indicator" id="engineStatus">Waiting for gesture</div>
                    </div>
                    
                    <div class="manual-triggers">
                        <h2>Manual Triggers</h2>
                        <div class="trigger-buttons">
                            <button class="primary" id="manualPop">Trigger Popunder</button>
                            <button class="secondary" id="manualInterstitial">Show Interstitial</button>
                        </div>
                    </div>
                </div>
            </div>
        </aside>
    </div>
    
    <div class="footer">
        Deploy to Vercel • Add domain to Monetag dashboard • Test in incognito & real devices
    </div>

    <script>
        // Configuration
        const CONFIG = {
            // Monetag integration placeholders
            monetagGlobal: 'REPLACE_MONETAG_GLOBAL_SCRIPT',
            monetagPopunder: '

// Rewarded Popup

show_10139509('pop').then(() => {
    // user watch ad till the end or close it in interstitial format
    // your code to reward user for rewarded format
}).catch(e => {
    // user get error during playing ad
    // do nothing or whatever you want
})

        ',
            monetagInterstitial: '

// Rewarded interstitial

show_10139509().then(() => {
    // You need to add your user reward function here, which will be executed after the user watches the ad.
    // For more details, please refer to the detailed instructions.
    alert('You have seen an ad!');
})

        ',
            monetagPush: '

// In-App Interstitial

show_10139509({
  type: 'inApp',
  inAppSettings: {
    frequency: 2,
    capping: 0.1,
    interval: 30,
    timeout: 5,
    everyPage: false
  }
})

/*
This value is decoded as follows:
- show automatically 2 ads
  within 0.1 hours (6 minutes)
  with a 30-second interval between them
  and a 5-second delay before the first one is shown.
  The last digit, 0, means that the session will be saved when you navigate between pages.
  If you set the last digit as 1, then at any transition between pages,
  the session will be reset, and the ads will start again.
*/

        ',
            
            // Ad frequency settings
            capPerSession: {
                popunder: 2,
                interstitial: 2,
                push: 3
            },
            
            // Timing settings
            popunderDelayMs: 700,
            interstitialAfterSec: 25,
            pushIntervalSec: 40,
            
            // Tier settings
            tier1Multiplier: 1.0,
            
            // Storage
            storageKey: 'mp_highcpm_session'
        };

        // State management
        let sessionData = {
            sessionId: Date.now(),
            score: 0,
            sessionTime: 0,
            adCounts: {
                popunder: 0,
                interstitial: 0,
                push: 0
            },
            lastPush: 0,
            firstGestureDone: false
        };

        // DOM elements
        const scoreEl = document.getElementById('score');
        const sessionTimeEl = document.getElementById('sessionTime');
        const engineStatusEl = document.getElementById('engineStatus');
        const playBtn = document.getElementById('playBtn');
        const claimBtn = document.getElementById('claimBtn');
        const manualPop = document.getElementById('manualPop');
        const manualInterstitial = document.getElementById('manualInterstitial');

        // Timer
        let sessionTimer = null;

        // Initialize
        function init() {
            // Load saved session data
            const saved = localStorage.getItem(CONFIG.storageKey);
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    // Only restore if session is from today
                    const today = new Date().toDateString();
                    const savedDay = new Date(parsed.sessionId).toDateString();
                    if (today === savedDay) {
                        sessionData = parsed;
                        updateUI();
                    }
                } catch (e) {
                    console.log('No valid session data found');
                }
            }
            
            // Set up event listeners
            playBtn.addEventListener('click', handlePlay);
            claimBtn.addEventListener('click', handleClaim);
            manualPop.addEventListener('click', triggerPopunder);
            manualInterstitial.addEventListener('click', triggerInterstitial);
            
            // Start session timer if we have an active session
            if (sessionData.sessionTime > 0) {
                startSessionTimer();
            }
            
            // Detect user tier
            detectUserTier();
        }

        // Update UI with current state
        function updateUI() {
            scoreEl.textContent = sessionData.score;
            sessionTimeEl.textContent = `${sessionData.sessionTime}s`;
        }

        // Start session timer
        function startSessionTimer() {
            if (sessionTimer) return;
            
            sessionTimer = setInterval(() => {
                sessionData.sessionTime++;
                sessionTimeEl.textContent = `${sessionData.sessionTime}s`;
                saveSession();
                
                // Check for interstitial after engagement period
                if (sessionData.sessionTime === CONFIG.interstitialAfterSec) {
                    if (sessionData.adCounts.interstitial < CONFIG.capPerSession.interstitial) {
                        triggerInterstitial();
                    }
                }
            }, 1000);
        }

        // Stop session timer
        function stopSessionTimer() {
            if (sessionTimer) {
                clearInterval(sessionTimer);
                sessionTimer = null;
            }
        }

        // Handle play button click
        function handlePlay() {
            // Increase score
            sessionData.score += Math.floor(Math.random() * 10) + 1;
            scoreEl.textContent = sessionData.score;
            
            // Start session if not already started
            if (sessionData.sessionTime === 0) {
                startSessionTimer();
            }
            
            // Handle first gesture for ad rotation
            if (!sessionData.firstGestureDone) {
                sessionData.firstGestureDone = true;
                engineStatusEl.textContent = 'Ad rotation active';
                
                // Trigger initial ad with delay
                setTimeout(() => {
                    triggerInitialAd();
                }, CONFIG.popunderDelayMs);
            }
            
            saveSession();
        }

        // Handle claim button click
        function handleClaim() {
            alert(`Congratulations! You've earned ${sessionData.score} points.`);
        }

        // Trigger initial ad based on user tier and availability
        function triggerInitialAd() {
            const isTier1 = sessionData.userTier === 'tier1';
            
            // Prefer popunder for Tier-1 users, push for others
            if (isTier1 && sessionData.adCounts.popunder < CONFIG.capPerSession.popunder) {
                triggerPopunder();
            } else if (sessionData.adCounts.push < CONFIG.capPerSession.push) {
                triggerPush();
            }
        }

        // Trigger popunder ad
        function triggerPopunder() {
            if (sessionData.adCounts.popunder >= CONFIG.capPerSession.popunder) {
                engineStatusEl.textContent = 'Popunder cap reached';
                return;
            }
            
            // In a real implementation, this would call the Monetag script
            const url = CONFIG.monetagPopunder;
            if (!url || url.startsWith('REPLACE')) {
                // Simulate popunder for demo
                engineStatusEl.textContent = 'Popunder triggered (demo)';
                simulatePopunder();
            } else {
                // Real implementation would go here
                // window.open(url, '_blank');
            }
            
            sessionData.adCounts.popunder++;
            saveSession();
        }

        // Trigger interstitial ad
        function triggerInterstitial() {
            if (sessionData.adCounts.interstitial >= CONFIG.capPerSession.interstitial) {
                engineStatusEl.textContent = 'Interstitial cap reached';
                return;
            }
            
            // In a real implementation, this would call the Monetag script
            const url = CONFIG.monetagInterstitial;
            if (!url || url.startsWith('REPLACE')) {
                // Simulate interstitial for demo
                engineStatusEl.textContent = 'Interstitial shown (demo)';
                simulateInterstitial();
            } else {
                // Real implementation would go here
            }
            
            sessionData.adCounts.interstitial++;
            saveSession();
        }

        // Trigger push ad
        function triggerPush() {
            const now = Date.now();
            if (sessionData.adCounts.push >= CONFIG.capPerSession.push) {
                return;
            }
            
            // Check push interval
            if (now - sessionData.lastPush < CONFIG.pushIntervalSec * 1000) {
                return;
            }
            
            // In a real implementation, this would call the Monetag script
            const url = CONFIG.monetagPush;
            if (!url || url.startsWith('REPLACE')) {
                // Simulate push for demo
                engineStatusEl.textContent = 'Push notification sent (demo)';
                simulatePush();
            } else {
                // Real implementation would go here
            }
            
            sessionData.adCounts.push++;
            sessionData.lastPush = now;
            saveSession();
        }

        // Detect user tier (simplified)
        function detectUserTier() {
            // In a real implementation, this would use more sophisticated detection
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const language = navigator.language;
            
            // Simple detection for demo purposes
            const isUSTier = timezone.includes('America') || 
                            language.includes('en-US') || 
                            language.includes('en_CA');
            
            sessionData.userTier = isUSTier ? 'tier1' : 'global';
            
            // Adjust multiplier for Tier-1
            if (isUSTier) {
                CONFIG.tier1Multiplier = 1.25;
            }
        }

        // Save session data to localStorage
        function saveSession() {
            localStorage.setItem(CONFIG.storageKey, JSON.stringify(sessionData));
        }

        // Simulate popunder for demo
        function simulatePopunder() {
            const popup = document.createElement('div');
            popup.style.position = 'fixed';
            popup.style.top = '0';
            popup.style.left = '0';
            popup.style.width = '100%';
            popup.style.height = '100%';
            popup.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
            popup.style.zIndex = '1000';
            popup.style.display = 'flex';
            popup.style.alignItems = 'center';
            popup.style.justifyContent = 'center';
            
            const content = document.createElement('div');
            content.style.background = 'white';
            content.style.padding = '20px';
            content.style.borderRadius = '8px';
            content.style.maxWidth = '400px';
            content.style.textAlign = 'center';
            content.style.color = 'black';
            
            content.innerHTML = `
                <h3 style="margin-bottom: 10px; color: #06b6d4;">Advertisement</h3>
                <p style="margin-bottom: 15px;">This would be a popunder ad in production</p>
                <button id="closePopup" style="padding: 8px 16px; background: #06b6d4; color: white; border: none; border-radius: 4px; cursor: pointer;">Close</button>
            `;
            
            popup.appendChild(content);
            document.body.appendChild(popup);
            
            document.getElementById('closePopup').addEventListener('click', () => {
                document.body.removeChild(popup);
            });
        }

        // Simulate interstitial for demo
        function simulateInterstitial() {
            const interstitial = document.createElement('div');
            interstitial.style.position = 'fixed';
            interstitial.style.top = '0';
            interstitial.style.left = '0';
            interstitial.style.width = '100%';
            interstitial.style.height = '100%';
            interstitial.style.backgroundColor = 'rgba(0, 0, 0, 0.9)';
            interstitial.style.zIndex = '1001';
            interstitial.style.display = 'flex';
            interstitial.style.alignItems = 'center';
            interstitial.style.justifyContent = 'center';
            interstitial.style.flexDirection = 'column';
            
            const content = document.createElement('div');
            content.style.background = 'linear-gradient(135deg, #1e293b, #334155)';
            content.style.padding = '30px';
            content.style.borderRadius = '12px';
            content.style.maxWidth = '500px';
            content.style.textAlign = 'center';
            content.style.color = 'white';
            content.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.5)';
            
            content.innerHTML = `
                <h3 style="margin-bottom: 15px; color: #06b6d4; font-size: 24px;">Special Offer</h3>
                <p style="margin-bottom: 20px; font-size: 16px;">This would be an interstitial ad in production</p>
                <button id="closeInterstitial" style="padding: 10px 20px; background: #06b6d4; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">Continue</button>
            `;
            
            interstitial.appendChild(content);
            document.body.appendChild(interstitial);
            
            document.getElementById('closeInterstitial').addEventListener('click', () => {
                document.body.removeChild(interstitial);
            });
        }

        // Simulate push notification for demo
        function simulatePush() {
            const notification = document.createElement('div');
            notification.style.position = 'fixed';
            notification.style.bottom = '20px';
            notification.style.right = '20px';
            notification.style.background = 'linear-gradient(135deg, #1e293b, #334155)';
            notification.style.color = 'white';
            notification.style.padding = '15px';
            notification.style.borderRadius = '8px';
            notification.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.3)';
            notification.style.zIndex = '1002';
            notification.style.maxWidth = '300px';
            notification.style.borderLeft = '4px solid #06b6d4';
            notification.style.transform = 'translateX(400px)';
            notification.style.transition = 'transform 0.3s ease';
            
            notification.innerHTML = `
                <div style="font-weight: 600; margin-bottom: 5px;">Advertisement</div>
                <div style="font-size: 14px; color: #94a3b8;">This would be a push notification in production</div>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Auto close after 5 seconds
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Initialize the app
        init();
    </script>
</body>
</html>

